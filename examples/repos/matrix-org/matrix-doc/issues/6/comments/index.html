[
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/70896349",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-70896349",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 70896349,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-21T18:46:20Z",
    "updated_at": "2015-01-21T18:46:20Z",
    "body": "All of leo's concerns above should now have been addressed (albeit mainly because the comments referred to the prior incarnation of the presence semantics).\r\n\r\nThe core functionality here (Sync, Scrollback, Context APIs and Actions) should now be complete and good for implementing as alpha.  Any other concerns, please voice them here asap."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/70997148",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-70997148",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 70997148,
    "user": {
      "login": "erikjohnston",
      "id": 8428120,
      "avatar_url": "https://avatars.githubusercontent.com/u/8428120?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erikjohnston",
      "html_url": "https://github.com/erikjohnston",
      "followers_url": "https://api.github.com/users/erikjohnston/followers",
      "following_url": "https://api.github.com/users/erikjohnston/following{/other_user}",
      "gists_url": "https://api.github.com/users/erikjohnston/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erikjohnston/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erikjohnston/subscriptions",
      "organizations_url": "https://api.github.com/users/erikjohnston/orgs",
      "repos_url": "https://api.github.com/users/erikjohnston/repos",
      "events_url": "https://api.github.com/users/erikjohnston/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erikjohnston/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-22T10:02:07Z",
    "updated_at": "2015-01-22T10:02:07Z",
    "body": "Sync\r\n-------\r\n> // 'format' gives the desired shape of the response\r\n> //   federation = include the federation layer as well as the raw content of events.\r\n> //   events = the plain events\r\n>  format: \"federation\",\r\n\r\nI think these choices of values are going to be confusing. The format for events that get sent to the client (for the most part) is a subset of keys that are sent over federation. Due to all the signing that goes on I always think of the federation event format to be canonical, while the (current) c-s format is simply a stripped down version.\r\n\r\nMy suggestions are \"full\" and \"stripped\"/\"partial\"/\"collapsed\" or something like that. At the very least can we change the value \"events\" to something else so that its clear that the stripped down versions of events are *not* the canonical format?\r\n\r\nScrollback\r\n--------------\r\nThe scrollback API doesn't seem to have a way of indicating the various states it could be in when returning less than the limit:\r\n\r\n- There are no more events in the room (i.e., we've paginated back to the start).\r\n- The server needs to talk to other servers to get more events (or is in the process of doing so).\r\n- The server has tried to find more events, but no other server has returned anything more. (We could still potentially retry again later.) "
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/70997428",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-70997428",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 70997428,
    "user": {
      "login": "erikjohnston",
      "id": 8428120,
      "avatar_url": "https://avatars.githubusercontent.com/u/8428120?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erikjohnston",
      "html_url": "https://github.com/erikjohnston",
      "followers_url": "https://api.github.com/users/erikjohnston/followers",
      "following_url": "https://api.github.com/users/erikjohnston/following{/other_user}",
      "gists_url": "https://api.github.com/users/erikjohnston/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erikjohnston/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erikjohnston/subscriptions",
      "organizations_url": "https://api.github.com/users/erikjohnston/orgs",
      "repos_url": "https://api.github.com/users/erikjohnston/repos",
      "events_url": "https://api.github.com/users/erikjohnston/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erikjohnston/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-22T10:04:17Z",
    "updated_at": "2015-01-22T10:04:17Z",
    "body": "Otherwise, looks OK."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71052912",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71052912",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71052912,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-22T16:49:30Z",
    "updated_at": "2015-01-22T16:49:30Z",
    "body": "Can we ``s/filter_id/filter_token/g`` please? Or is ID chosen for a particular reason?"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71133671",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71133671",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71133671,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-23T01:34:32Z",
    "updated_at": "2015-01-23T01:34:32Z",
    "body": "On 22/01/2015 16:49, Kegsay wrote:\n> Can we |s/filter_id/filter_token/g| please? Or is ID chosen for a\n> particular reason?\n\nfilter_id not filter_token as the token doesn't change between uses of \nthe filter\nunlike batch_tokens which keep changing and are fairly ephemeral\nbatch_tokens represent a token in a stream\nwhereas a filter_id is just, well, the ID you use to refer to a \nparticular filter\njust like a room_id or user_id."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71161769",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71161769",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71161769,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-23T08:28:29Z",
    "updated_at": "2015-01-23T08:28:29Z",
    "body": "Okay, that seems reasonable. We do reserve the right for home servers to expire filter ids, but it should be infrequent enough to not be confusing. "
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71505910",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71505910",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71505910,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T18:00:19Z",
    "updated_at": "2015-01-26T18:00:19Z",
    "body": "From earlier on #matrix-dev:\r\n> hmm, just had a thought on filters. For the /sync API, what I really want is to say \"``limit=10`` for this filter ID, but return results from this filter ID\" which is awkward since we don't currently support that. I want the web client to get all events (for display in the room dialog), but I want to apply ``limit=10`` for displayable events.\r\n\r\n> in terms of the API changes, it would just be something like ``filter_limit=$filter_id``  I guess, so it's not the end of the world, but I need to work through an exact example of what that would look like. I guess all ``filter_limit`` is doing is serving as the filter to determine what counts as \"10\" when you say ``limit=10``, but return results by filtering on ``filter=``\r\n\r\nThis concept needs to be added to the HTTP spec. The use case being the web client: I want to display the 10 most recent displayable events, but I want to *receive* all the different event types evar so I can populate the state events dialog, which currently you can't do."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71510342",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71510342",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71510342,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T18:25:43Z",
    "updated_at": "2015-01-26T18:25:43Z",
    "body": "I guess this could be done as two /sync requests, one for displayable events limit 10, and another for the current state (limit 0?). The main downside to what I suggested above is that there is an indeterminate amount of events between the most recent 10 displayable events and \"now\" potentially. "
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71511065",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71511065",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71511065,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T18:29:30Z",
    "updated_at": "2015-01-26T18:29:30Z",
    "body": "Surely the problem here is that we want may want total state for the room (which can't be paginated currently), but only 10 visible events.  limit=10 would never apply to state anyway, so how about having two filter params - one specifically for state, and the other specifically for general timeline events?"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71614071",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71614071",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71614071,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T09:18:31Z",
    "updated_at": "2015-01-27T09:18:31Z",
    "body": "That could work. I could then say ``state_filter=*`` and ``msg_filter=[m.room.message/topic/name/member]`` and be done with it, and we preserve the original proposed behaviour by specifying the same filter for both."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71615790",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71615790",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71615790,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T09:32:10Z",
    "updated_at": "2015-01-27T09:32:10Z",
    "body": "in spec-3 we defined non-state events to be called messages. instead i suggest events_filter or timeline_filter or even graph_filter?\r\n\r\n\r\n> On 27 Jan 2015, at 09:18, Kegsay <notifications@github.com> wrote:\r\n> \r\n> That could work. I could then say state_filter=* and msg_filter=[m.room.message/topic/name/member] and be done with it, and we preserve the original proposed behaviour by specifying the same filter for both.\r\n> \r\n> â€”\r\n> Reply to this email directly or view it on GitHub.\r\n> "
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71623317",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71623317",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71623317,
    "user": {
      "login": "NegativeMjark",
      "id": 904009,
      "avatar_url": "https://avatars.githubusercontent.com/u/904009?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NegativeMjark",
      "html_url": "https://github.com/NegativeMjark",
      "followers_url": "https://api.github.com/users/NegativeMjark/followers",
      "following_url": "https://api.github.com/users/NegativeMjark/following{/other_user}",
      "gists_url": "https://api.github.com/users/NegativeMjark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NegativeMjark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NegativeMjark/subscriptions",
      "organizations_url": "https://api.github.com/users/NegativeMjark/orgs",
      "repos_url": "https://api.github.com/users/NegativeMjark/repos",
      "events_url": "https://api.github.com/users/NegativeMjark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NegativeMjark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T10:29:56Z",
    "updated_at": "2015-01-27T10:29:56Z",
    "body": "Should control over what state is filtered and what events are filtered be part of the filter itself? Rather than having two filters. Especially if we are using the filter to control what format the events are in given that the event_map contains both events from the state and from the recent events."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71625420",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71625420",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71625420,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T10:47:16Z",
    "updated_at": "2015-01-27T10:47:16Z",
    "body": "> events_filter or timeline_filter or even graph_filter?\r\n\r\nGiven these are events which appear in the ``events`` key for a room, I like ``events_filter``.\r\n\r\n> Should control over what state is filtered and what events are filtered be part of the filter itself?\r\n\r\nMy gut reaction originally said \"no, the filter just controls which events are obtained and how each event is represented (eg which keys), not *room* related stuff\". However, there is already a precedent for modifying global/room stuff via ``public_user_data: true,`` and co. Therefore, I agree with Mark and think that this should probably form part of the filter. If it is part of the filter, should we be mimicking the structure of the ``/sync`` response more to make the relation clearer? Something like:\r\n```\r\nroom: {\r\n  state: {\r\n    types: [\"something\"],\r\n    not_senders: [\"@foo:bar\"]\r\n  },\r\n  events: {\r\n    types: [\"something\"],\r\n    not_senders: [\"@foo:bar\"]\r\n  }\r\n}\r\n```\r\nWhich would end up with rather satisfyingly symmetric filter request keys/sync response keys:\r\n```\r\nCreating filter:\r\n{\r\n  room: {\r\n    state: {\r\n      types: [\"something\"],\r\n      not_senders: [\"@foo:bar\"]\r\n    },\r\n    events: {\r\n      types: [\"something\"],\r\n      not_senders: [\"@foo:bar\"]\r\n    }\r\n  },\r\n  public_user_data: true,\r\n  private_user_data: true\r\n}\r\n\r\nSync response:\r\n{\r\n  next_batch: \"foo\",\r\n  rooms: [\r\n    {\r\n      state: [ event_ids ],\r\n      events: [ event_ids ],\r\n      ...\r\n    }\r\n  ],\r\n  public_user_data: [\r\n    { event }\r\n  ],\r\n  private_user_data: [\r\n    { event }\r\n  ]\r\n}\r\n```\r\nDo we want public/private user data to just be bools at this point? If they are, which filter is applied when I say ``public_user_data: true``? The state one? It's not clear. We also need clear guidelines on what would be public_user_data (e.g. an event without a ``room_id``)."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71628585",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71628585",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71628585,
    "user": {
      "login": "NegativeMjark",
      "id": 904009,
      "avatar_url": "https://avatars.githubusercontent.com/u/904009?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NegativeMjark",
      "html_url": "https://github.com/NegativeMjark",
      "followers_url": "https://api.github.com/users/NegativeMjark/followers",
      "following_url": "https://api.github.com/users/NegativeMjark/following{/other_user}",
      "gists_url": "https://api.github.com/users/NegativeMjark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NegativeMjark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NegativeMjark/subscriptions",
      "organizations_url": "https://api.github.com/users/NegativeMjark/orgs",
      "repos_url": "https://api.github.com/users/NegativeMjark/repos",
      "events_url": "https://api.github.com/users/NegativeMjark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NegativeMjark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T11:04:15Z",
    "updated_at": "2015-01-27T11:04:15Z",
    "body": "Should we be specifying separate lists for public/private user data as well rather than true/false?\r\nCreating filter:\r\n\r\n    {\r\n     room: {\r\n       state: {\r\n         types: [\"something\"],\r\n         not_senders: [\"@foo:bar\"]\r\n       },\r\n       events: {\r\n         types: [\"something\"],\r\n         not_senders: [\"@foo:bar\"]\r\n       }\r\n     },\r\n     public_user_data: {\r\n       types: [\"something\"],\r\n       not_senders: [\"@foo:bar\"]\r\n     },\r\n     private_user_data: {\r\n       types: [\"something\"],\r\n       not_senders: [\"@foo:bar\"]\r\n     }\r\n    }\r\n"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71630092",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71630092",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71630092,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T11:12:42Z",
    "updated_at": "2015-01-27T11:12:42Z",
    "body": "That looks good to me. This way you know exactly what you're filtering on for each key in ``/sync``. As for determining the \"pool\" of events that you're filtering on, the room ones are fairly obvious (timeline order for ``events`` and presence of ``state_key`` for ``state``), but the other 2 are more interesting. Presumably, the absence of a ``room_id`` means that it is ``public_user_data``, but where does typing fit into this?\r\n\r\nWe need to work out the semantics for ``private_user_data`` too. Given it's user only, and given it's just a generic store, it is probably Good Enough to just say \"hey, if you PUT stuff to your private userdata then you can filter on it if you know which events you're working with\". I would typically use this to store app-specific config info in my own event type namespace e.g. ``org.matrix.console.android.*`` and then use that as my filter on ``private_user_data``."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71630668",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71630668",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71630668,
    "user": {
      "login": "erikjohnston",
      "id": 8428120,
      "avatar_url": "https://avatars.githubusercontent.com/u/8428120?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erikjohnston",
      "html_url": "https://github.com/erikjohnston",
      "followers_url": "https://api.github.com/users/erikjohnston/followers",
      "following_url": "https://api.github.com/users/erikjohnston/following{/other_user}",
      "gists_url": "https://api.github.com/users/erikjohnston/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erikjohnston/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erikjohnston/subscriptions",
      "organizations_url": "https://api.github.com/users/erikjohnston/orgs",
      "repos_url": "https://api.github.com/users/erikjohnston/repos",
      "events_url": "https://api.github.com/users/erikjohnston/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erikjohnston/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T11:16:09Z",
    "updated_at": "2015-01-27T11:16:09Z",
    "body": "> Presumably, the absence of a room_id means that it is public_user_data, but where does typing fit into this?\r\n\r\nCan we *please* have a better way of differentiating types of events than this? An absence of a `room_id` key really only means that its not tied to a room; for example I want to people able to send down server status messages which won't have a `room_id`."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71631684",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71631684",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71631684,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T11:25:06Z",
    "updated_at": "2015-01-27T11:25:06Z",
    "body": "More than happy with mjarkegan's suggestion above; my bad for not proposing it in the first place.\r\nNot sure why Erik is worried about distinguishing user_data from graph and state events given we surely just look at where in the /sync datastructure they're returned... (i.e. are they in a user_data key, or a state key, or an events key?)"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71631849",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71631849",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71631849,
    "user": {
      "login": "NegativeMjark",
      "id": 904009,
      "avatar_url": "https://avatars.githubusercontent.com/u/904009?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NegativeMjark",
      "html_url": "https://github.com/NegativeMjark",
      "followers_url": "https://api.github.com/users/NegativeMjark/followers",
      "following_url": "https://api.github.com/users/NegativeMjark/following{/other_user}",
      "gists_url": "https://api.github.com/users/NegativeMjark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NegativeMjark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NegativeMjark/subscriptions",
      "organizations_url": "https://api.github.com/users/NegativeMjark/orgs",
      "repos_url": "https://api.github.com/users/NegativeMjark/repos",
      "events_url": "https://api.github.com/users/NegativeMjark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NegativeMjark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-27T11:26:46Z",
    "updated_at": "2015-01-27T11:26:46Z",
    "body": "I think Erik is complaining that we have lost the ability for servers to send *messages* to a client outside of a room."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71855642",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71855642",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71855642,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-28T15:41:39Z",
    "updated_at": "2015-01-28T15:41:39Z",
    "body": "So the outstanding problems on this are:\r\n- Where do ``m.typing`` events go?\r\n- Where do server-generated events not scoped to a room go?\r\n\r\nThe general API mentions that there should be a prefix to the event type to indicate state/message/ephemeral event. We currently determine the different kinds of events based on the keys e.g. ``state`` vs ``events`` vs ``public_user_data``, so it may be worth adding in different sections for these kinds of events? E.g.\r\n```\r\n{\r\n room: {\r\n   state: {\r\n     types: [\"something\"],\r\n     not_senders: [\"@foo:bar\"]\r\n   },\r\n   events: {\r\n     types: [\"something\"],\r\n     not_senders: [\"@foo:bar\"]\r\n   },\r\n   ephemeral: {\r\n     types: [\"something\"],\r\n     not_senders: [\"@foo:bar\"]\r\n   }\r\n },\r\n public_user_data: {\r\n   types: [\"something\"],\r\n   not_senders: [\"@foo:bar\"]\r\n },\r\n private_user_data: {\r\n   types: [\"something\"],\r\n   not_senders: [\"@foo:bar\"]\r\n },\r\n server_data: {\r\n   types: [\"something\"],\r\n   not_senders: [\"@foo:bar\"]\r\n }\r\n}\r\n```\r\n\r\nThis covers all the different kinds of events which exist (or are planned to exist in the future):\r\n- Room state events like ``m.room.name`` : ``room.state``\r\n- Room events (state and message) like ``m.room.message``: ``room.events``\r\n- Room EDUs like ``m.typing``: ``room.ephemeral``\r\n- Private user data like push/app specific configs: ``private_user_data``\r\n- Public user data like ``m.profile`` and ``m.presence``: ``public_user_data``\r\n- Server-generated events (not room scoped): ``server_data``\r\n- Server-generated events (room-scoped), with modified ``sender`` as per general API: ``room.events``\r\n\r\nThis would negate the need to prefix event types since you can tell what kind of event it is based on the key it is inside of. For sending those event types, you hit different CS endpoints e.g. ``/user/{userId}/public/{eventType}`` for ``public_user_data``, ``/room/{roomId}/state/{eventType}/{stateKey}`` for ``room.state``, and so on."
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/71859156",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-71859156",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 71859156,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-28T15:58:37Z",
    "updated_at": "2015-01-28T15:58:37Z",
    "body": "On 28/01/2015 15:41, Kegsay wrote:\n> So the outstanding problems on this are:\n> The general API mentions that there should be a prefix to the event type\n> to indicate state/message/ephemeral event. We currently determine the\n> different kinds of events based on the keys e.g. |state| vs |events| vs\n> |public_user_data|, so it may be worth adding in different sections for\n> these kinds of events?\n\nwfm"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/73388506",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-73388506",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 73388506,
    "user": {
      "login": "ara4n",
      "id": 1294269,
      "avatar_url": "https://avatars.githubusercontent.com/u/1294269?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ara4n",
      "html_url": "https://github.com/ara4n",
      "followers_url": "https://api.github.com/users/ara4n/followers",
      "following_url": "https://api.github.com/users/ara4n/following{/other_user}",
      "gists_url": "https://api.github.com/users/ara4n/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ara4n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ara4n/subscriptions",
      "organizations_url": "https://api.github.com/users/ara4n/orgs",
      "repos_url": "https://api.github.com/users/ara4n/repos",
      "events_url": "https://api.github.com/users/ara4n/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ara4n/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-07T23:24:39Z",
    "updated_at": "2015-02-07T23:24:39Z",
    "body": "kegan: the last commit doesn't seem entirely complete - don't we need ephemeral blocks on the response for /sync too?  And do we have a way to distinguish ephemeral non-room data from non-ephemeral?"
  },
  {
    "url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/comments/75040203",
    "html_url": "https://github.com/matrix-org/matrix-doc/pull/6#issuecomment-75040203",
    "issue_url": "https://api.github.com/repos/matrix-org/matrix-doc/issues/6",
    "id": 75040203,
    "user": {
      "login": "Kegsay",
      "id": 7190048,
      "avatar_url": "https://avatars.githubusercontent.com/u/7190048?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kegsay",
      "html_url": "https://github.com/Kegsay",
      "followers_url": "https://api.github.com/users/Kegsay/followers",
      "following_url": "https://api.github.com/users/Kegsay/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kegsay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kegsay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kegsay/subscriptions",
      "organizations_url": "https://api.github.com/users/Kegsay/orgs",
      "repos_url": "https://api.github.com/users/Kegsay/repos",
      "events_url": "https://api.github.com/users/Kegsay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kegsay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-19T11:54:46Z",
    "updated_at": "2015-02-19T11:54:46Z",
    "body": "> don't we need ephemeral blocks on the response for /sync too?\r\n\r\nWhat's the use case?\r\n\r\n> do we have a way to distinguish ephemeral non-room data from non-ephemeral?\r\n\r\nWhen would we want ephemeral non-room data?\r\n\r\nIt's a lot easier to add these fields in at a later date, but very difficult to remove them if they turn out to be duds, hence prompting for use cases."
  }
]
